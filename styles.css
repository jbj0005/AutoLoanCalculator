:root{
  --bg: #0b0f14;
  --panel: #10161d;
  --text: #e7edf3;
  --muted: #9fb1c1;
  --accent: #4cc38a;
  --warn: #d97706;
  --danger: #ef4444;
  --border: #1f2a36;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
  background: var(--bg);
  color: var(--text);
}

.app-header{
  padding: 16px 20px;
  border-bottom: 1px solid var(--border);
}
.app-header.center{ text-align:center }
.app-header h1{
  margin: 0;
  font-size: 22px;
}

.container{ max-width: 100%; margin: 0 auto; padding: 16px }

.panel{
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 14px;
  margin: 0 auto 16px auto; /* center panels */
  max-width: 380px; /* narrow card by default */
}
/* Vehicle card can grow to fit controls while staying centered */
#db-panel{ width: min(100%, 680px); max-width: 680px }
.panel-header{display:flex; align-items:center; gap:12px; justify-content:space-between}
/* Vehicle DB header uses grid to center actions over select column */
#db-panel .panel-header{ display:grid; grid-template-columns: 140px 1fr auto; align-items:center; column-gap: 12px }
#db-panel .panel-header .header-actions{ display:flex; gap:8px; justify-self: center }
#db-panel .panel-header #supabase-status{ justify-self: end }
.panel-header h2{margin:0; font-size:16px}

.status{font-size:12px; padding:4px 8px; border-radius:999px; border:1px solid var(--border); color:var(--muted); display:inline-flex; align-items:center; justify-content:center; text-align:center}
.status.ok{color:var(--accent)}
.status.warn{color:var(--warn)}
.status.err{color:var(--danger)}

.db-row{display:grid; grid-template-columns: 140px 1fr; gap:10px; align-items:center; margin:8px 0}
.db-row{ overflow: hidden }
#db-panel .db-row .row-actions{ min-width: 0 }
#db-panel .db-row .row-actions select{ min-width: 0; width: 100%; max-width: 100% }
.vehicles-row{ grid-template-columns: 140px minmax(0,1fr) auto }
#db-panel .db-row.vehicles-row #supabase-status{ justify-self: end }
.db-row .row-actions{display:flex; gap:8px; align-items:center}
.db-row .row-actions{flex-wrap: wrap}
.db-row .row-actions select{flex:1 1 200px; min-width:200px}
.db-row .row-actions .btn{flex:0 0 auto}
.db-row label{color:var(--muted)}
.db-form{margin-top:8px; padding-top:8px; border-top:1px dashed var(--border)}
.db-form-title{font-size:12px; color:var(--muted); margin:4px 0 6px}

.db-meta{font-size:12px; color:var(--muted); display:flex; flex-direction:column; gap:4px; margin-top:6px}
.db-meta-actions{display:flex; gap:8px; justify-content:center; flex-wrap:wrap; margin-top:8px}


.summary{background: var(--panel); border:1px solid var(--border); border-radius:10px; padding:10px; margin:0 auto 16px auto; max-width: 380px; display:flex; gap:12px; justify-content:center; align-items:center; text-align:center; flex-wrap:wrap}
.summary .item{font-size:12px; color: var(--muted)}
.summary .item .value{color: var(--text)}
/* Remove calculator-style borders on summary values */
.summary .value{background: transparent; border:none; padding:0; border-radius:0}

/* Add a bit more space between Calculator title and first field */
#calc-panel .stack{ margin-top: 8px }

.stack{display:flex; flex-direction:column; gap:10px; align-items:stretch}
.cell{display:flex; flex-direction:column; gap:6px; background:#0f1319; border:1px solid var(--border); border-radius:8px; padding:10px}
.cell-label{font-size:12px; color: var(--muted); text-transform: uppercase}
.cell-label.with-action{ display:flex; align-items:center; justify-content: space-between; gap:8px }
.label{font-size:12px; color: var(--muted); padding:10px 0}
.value{background:#0f1319; border:1px solid var(--border); border-radius:8px; padding:10px; max-width: 380px}
.value input, .value select, .settings-grid input, .cell-value input, .cell-value select{
  width:100%;
  padding: 10px 12px;
  border-radius:8px;
  border: 1px solid var(--border);
  background: #0f1319; /* match card background */
  color: var(--text);
}
.value output{font-variant-numeric: tabular-nums}
.big{font-size: 20px; font-variant-numeric: tabular-nums}
.placeholder{ font-size: 12px !important; color: var(--muted) !important; }
.big.placeholder{ font-size: 12px !important; font-variant-numeric: normal }
.note{margin-top:6px; font-size:12px; color: var(--muted); opacity: .75; white-space: nowrap}
.note.warn{color: var(--warn)}
.note.faint{opacity:.75}
.hint{white-space: nowrap}
.wrap-note{ white-space: normal }
.nowrap{white-space: nowrap}
.hint{margin-top:6px; font-size:12px; color: var(--muted); opacity: .75}

.amount-row{display:flex; align-items:center; gap:12px; justify-content:space-between}
.amount-row .checkbox{white-space: nowrap}
/* Slightly smaller label + checkbox in Amount Financed row */
#calc-panel .amount-row .checkbox{ font-size: 12px }
#calc-panel .amount-row .checkbox input[type="checkbox"]{ width:14px; height:14px }

.checkbox{display:flex; align-items:center; gap:8px}
input[type="checkbox"]{width:16px; height:16px}

.fees-list{display:flex; flex-direction:column; gap:8px}
.fee-row{display:grid; grid-template-columns: 1fr 140px auto; gap:8px; align-items:center}
.fee-row input{width:100%}
.fee-row .remove{background: transparent; border:1px solid var(--border); color: var(--muted); padding:8px 10px; border-radius:8px}
.fees-actions{display:flex; align-items:center; gap:8px; margin-top:8px}
.fees-actions .spacer{flex:1}

.btn{background:#1a2330; color:var(--text); border:1px solid var(--border); border-radius:8px; padding:8px 12px; cursor:pointer}
.btn:hover{filter:brightness(1.1)}
.btn.primary{background: #1b2f23; border-color: #1f3a2b; color:#d9ffe9}
.btn.small{padding:6px 10px; font-size:12px}

.messages{font-size:12px; color: var(--muted)}
.messages .warn{color: var(--warn)}

.settings-grid{display:grid; grid-template-columns: 1fr 1fr; gap:14px}

.footer{color:var(--muted); font-size:12px; text-align:center; margin: 16px 0}

/* Modal */
.modal{position:fixed; inset:0; background:rgba(0,0,0,.5); display:none; align-items:center; justify-content:center; padding:16px; z-index:50}
.modal.open{display:flex}
.modal-dialog{background:var(--panel); border:1px solid var(--border); border-radius:12px; width:100%; max-width: 560px; box-shadow:0 10px 30px rgba(0,0,0,.4)}
.modal-header, .modal-footer{display:flex; align-items:center; justify-content:space-between; padding:12px 14px; border-bottom:1px solid var(--border)}
.modal-footer{border-top:1px solid var(--border); border-bottom:none}
.modal-body{padding:12px 14px}

/* Vehicle dropdown matches card background */
#db-panel select#vehicleSelect{
  background: var(--panel);
  color: var(--text);
  border: 1px solid var(--border);
  padding: 10px 12px;
  border-radius: 8px;
}

.rates-preview{ margin-top: 10px }
.preview-table{ width:100%; border-collapse: collapse; font-size:12px }
.preview-table th, .preview-table td{ border:1px solid var(--border); padding:6px 8px }
.preview-table th{ color: var(--muted); text-align:left; background:#0f1319 }

.link-btn{ background: transparent; border: none; color: var(--accent); cursor: pointer; padding:0 2px; font-size: inherit; line-height: inherit }
.link-btn:hover{ text-decoration: underline }

/* Tooltip (hover/click) for notes */
/* (removed tooltip hover bubble in favor of modal) */

/* Make inputs in the Rates modal high-contrast for readability */
#ratesModal input[type="text"],
#ratesModal input[type="number"],
#ratesModal input[type="file"]{
  background: #ffffff !important;
  color: #000000 !important;
  border: 1px solid var(--border);
}

/* Contain and wrap content inside the Rates modal */
#ratesModal .modal-body{ overflow-x: auto; }
#ratesModal .hint, #ratesModal .note{ white-space: normal; }
#ratesModal textarea{ max-width: 100%; width: 100%; box-sizing: border-box; }
#ratesModal .preview-table{ table-layout: fixed; width: 100%; }
#ratesModal .preview-table th, #ratesModal .preview-table td{ word-break: break-word; white-space: normal; }

/* Style the file upload button where supported */
#ratesModal input[type="file"]::file-selector-button{
  background: #eeeeee;
  color: #000000;
  border: 1px solid var(--border);
  border-radius: 6px;
  padding: 6px 10px;
  margin-right: 8px;
  cursor: pointer;
}
#ratesModal input[type="file"]::-webkit-file-upload-button{
  background: #eeeeee;
  color: #000000;
  border: 1px solid var(--border);
  border-radius: 6px;
  padding: 6px 10px;
  margin-right: 8px;
  cursor: pointer;
}

/* Vehicle modal inputs match calculator card */
#vehicleModal input, #vehicleModal select{
  background: #0f1319;
  color: var(--text);
  border: 1px solid var(--border);
}
#vehicleModal input::placeholder{ color: var(--muted); opacity: .85 }

/* Consistent input font sizing across panels and modal */
.panel input, .panel select, .modal input, .modal select{
  font-size: 14px;
  color: var(--text);
}

/* Input with suffix (e.g., Months) */
.input-with-suffix{display:flex; align-items:center; gap:6px}
.input-with-suffix .suffix{font-size:12px; color: var(--muted)}

@media (max-width: 900px){ }
@media (max-width: 640px){ .db-row{grid-template-columns: 1fr} }

/* Equity negative style (accounting-style) */
.delta-neg{color:#fda4a4; background:#3a0f13; padding:2px 6px; border-radius:6px}
.delta-pos{color:#9ff3c3; background:#12281d; padding:2px 6px; border-radius:6px}
.inline-2{display:flex; gap:8px}
.inline-2 > *{flex:1}

/* Trade-in consolidated layout */
.trade-grid{ display:grid; grid-template-columns: minmax(0,1fr) auto minmax(0,1fr) auto minmax(0,1fr); column-gap:8px; row-gap:6px; align-items:center }
.trade-grid .t-label{ font-size:12px; color: var(--muted); text-transform: none }
.trade-grid .op{ color: var(--muted) }
#tradeEquity{ font-size:14px; font-variant-numeric: tabular-nums }
